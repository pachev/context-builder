# Context Builder

This file provides essential information about the Context Builder project structure, conventions, and important implementation details for Claude and other AI assistants.

## Project Overview

Context Builder is a native macOS application that helps users create context files for LLMs (Large Language Models). The application allows users to visually browse project files, select which ones to include in the context, and generate formatted output for use with LLMs like Claude.

## Key Features

- File explorer with checkboxes for easy selection
- Project tree overview at the top
- Option to include project structure in the generated context
- Multiple output formats: XML, Markdown, and Plain Text
- Line numbering option
- File filtering (hidden files, .gitignore rules)
- Token count estimation

## Project Structure

```
context-builder/
├── .gitignore
├── .python-version      # Created by UV
├── README.md
├── pyproject.toml       # Project configuration and dependencies
├── uv.lock              # Dependency lock file (generated by UV)
├── .venv/               # Virtual environment (generated by UV)
├── src/
│   └── context_builder/
│       ├── __init__.py  # Package marker and version
│       ├── __main__.py  # Entry point for running as module
│       ├── app.py       # Main application GUI code
│       └── cli.py       # Command-line interface code
```

## Architecture

The project follows a modular design with these main components:

1. **Main Application (app.py)**
   - Contains the GUI implementation using PyQt6
   - Implements file tree visualization, file selection, and output generation
   - Handles user interactions and file operations

2. **Command-Line Interface (cli.py)**
   - Provides a command-line entry point for the application
   - Handles command-line arguments and launches the GUI

3. **Entry Points**
   - `__main__.py`: For running as a Python module
   - `ctx-builder` command: Defined in pyproject.toml

## Implementation Details

### File Tree Models

The project uses two tree view implementations:
- `ProjectTreeView`: Display-only view of the project structure
- `FileTree`: Interactive view with checkboxes for file selection

Both trees respect the filter settings (hidden files, .gitignore).

### Output Formats

The application supports three output formats:
1. **XML**: A structured format with document tags
   ```xml
   <documents>
     <document index="1">
       <source>path/to/file.py</source>
       <document_content>file content here</document_content>
     </document>
   </documents>
   ```

2. **Markdown**: Uses fenced code blocks with language detection
   ```markdown
   path/to/file.py
   ```python
   file content here
   ```
   ```

3. **Plain Text**: Simple format with file paths and separators
   ```
   path/to/file.py
   ---
   file content here
   ---
   ```

### Project Structure Generation

The application can include a text-based tree view of the project structure at the beginning of the generated context. This feature:
- Is toggled with the "Include Project Structure" checkbox
- Respects the same filtering rules as the main application
- Uses standard tree characters (├── and └──) for visualization

## Package Management

This project uses [UV](https://github.com/astral-sh/uv), a fast Python package manager written in Rust. UV handles:
- Virtual environment creation and management
- Dependency resolution and installation
- Project packaging and distribution

## Common Commands

```bash
# Install dependencies
uv sync

# Run the application
uv run -- ctx-builder .

# Add a dependency
uv add dependency_name

# Build the package
uv build
```

## Code Style and Conventions

- Class names use CamelCase (e.g., `ContextBuilder`, `FileTree`)
- Function and method names use snake_case (e.g., `update_preview`, `get_project_structure`)
- Constants use UPPER_SNAKE_CASE (e.g., `EXT_TO_LANG`)
- Indentation uses 4 spaces
- Line length should not exceed 100 characters

## UI Component Hierarchy

```
ContextBuilder (QMainWindow)
└── main_widget (QWidget)
    ├── project_tree (ProjectTreeView)
    └── main_splitter (QSplitter)
        ├── file_tree_widget
        │   ├── file_tree (FileTree)
        │   └── file_buttons_layout
        │       ├── select_all_btn
        │       └── deselect_all_btn
        └── right_widget
            ├── preview_header_layout
            │   └── token_layout
            │       └── token_count (QLabel)
            ├── preview (QTextEdit)
            └── generate_btn (QPushButton)
```
